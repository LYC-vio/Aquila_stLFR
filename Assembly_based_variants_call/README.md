# Assembly-based variants calling 

## Dependencies:

## Running The Code:
Put the "Aquila/bin" in the ".bashrc" file, and source the ".bashrc" file <br />
Or use the fullpath of "Aquila_assembly_based_variants_call.py" and "Aquila_phasing_all_variants.py"

```
Aquila/bin/Aquilla_assembly_based_variants_call.py --assembly_dir Assembly_results_S12878 --out_dir Variants_results_S12878 --ref_file Aquila/source/ref.fa 
```
#### *Required parameters
##### --assembly_dir: "Assembly_results_S12878" is the output folder from assembly.

##### --ref_file: "Aquila/source/ref.fa" is the reference fasta file from GRCh38.

#### *Optional parameters
#####  --out_dir, default = ./Variants_results

##### --chr_start, --chr_end: if you only want to call variants from some chromosomes or only one chromosome. For example: use "--chr_start 1 --chr_end 5"  will call variants from chromsomes 1,2,3,4,5. Use "--chr_start 2 --chr_end 2" will only call variants from chromosome 2. 

#### Final Output
##### "Aquila_final_sorted.vcf"

# Phasing all types of variants  

```
Aquila/bin/Aquila_phasing_all_variants.py --assembled_vcf Variants_results_S12878/Aquila_final_sorted.vcf --vcf_file S12878_freebayes.vcf --assembly_dir Assembly_results_S12878
```
#### *Required parameters
##### --assembled_vcf: "Variants_results_S12878/Aquila_final_sorted.vcf" which will be generated by the previous step.
##### --vcf_file: "S12878_freebayes.vcf", it is the origin vcf file generated by FreeBayes. 
##### --assembly_dir: "Assembly_results_S12878" is the output folder from assembly.

#### *Optional parameters
#####  --out_dir, default = ./results_phasing_vcf

##### --chr_start, --chr_end: if you only want to call variants from some chromosomes or only one chromosome. For example: use "--chr_start 1 --chr_end 5"  will call variants from chromsomes 1,2,3,4,5. Use "--chr_start 2 --chr_end 2" will only call variants from chromosome 2. 

#####  --block_len_use, default = 100000, it is the same "--block_len_use" used in assembly steps. 

#### Final Output
##### "Aquila_all_phased_sorted.vcf"
